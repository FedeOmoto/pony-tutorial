<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Exceptions - Pony Tutorial</title>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script>

  <style>
    body {font-size: 90%;}
    pre, code {font-size: 100%;}
    h3, h4, h5, h6 {color: #2980b9; font-weight: 300}
  </style> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Pony Tutorial</a>
        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
      <ul class="current">
    
        
        <span>Installation</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../installation/mac-osx">Mac OSX</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../installation/linux">Linux</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../installation/windows">Windows</a>
                    
                </li>
            
        

    
        
        <span>Getting started</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../getting-started/what-you-need-to-start">What you need to start</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../getting-started/helloworld">Helloworld</a>
                    
                </li>
            
        

    
        
        <span>Types</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../types/classes">Classes</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../types/primitives">Primitives</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../types/type-alias">Type aliases</a>
                    
                </li>
            
        

    
        
        <span>Whitespace Sensitivity</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../whitespace/sensitivity">Overview</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../whitespace/semicolons">Semicolons</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../whitespace/comments">Comments</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../whitespace/docstrings">Docstrings</a>
                    
                </li>
            
        

    
        
        <span>Variables</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../variables/let-vs-var">let vs. var</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../variables/parameters">Parameters</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../variables/fields">Fields</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../variables/literals">Literals</a>
                    
                </li>
            
        

    
        
        <span>Basic control structures</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../control-structures/conditionals">Conditionals</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../control-structures/operator-precedence">Operator precedence</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../control-structures/loops">Loops</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../control-structures/expressions-everywhere">Expressions</a>
                    
                </li>
            
        

    
        
        <span>Methods</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../methods/constructors">Constructors</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../methods/functions">Functions</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../methods/named-and-default-args">Named and default arguments</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../methods/partial-functions">Partial functions</a>
                    
                </li>
            
        

    
        
        <span>Actors</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../actors/behaviours">Behaviours</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../actors/capabilities">Capabilities</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../actors/recover-and-consume">recover and consume</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../actors/arrow-types">Arrow types</a>
                    
                </li>
            
        

    
        
        <span>Exceptions</span>
            
                <li class="toctree-l1 current">
                    <a class="current" href=".">Exceptions</a>
                    
                        <ul>
                        
                            <li class="toctree-l2"><a href="#exceptions">Exceptions</a></li>
                            
                                <li><a class="toctree-l3" href="#throwing-and-catching">Throwing and catching</a></li>
                            
                                <li><a class="toctree-l3" href="#partial-functions">Partial functions</a></li>
                            
                                <li><a class="toctree-l3" href="#parital-constructors-and-behaviours">Parital constructors and behaviours</a></li>
                            
                                <li><a class="toctree-l3" href="#try-then-blocks">Try-then blocks</a></li>
                            
                                <li><a class="toctree-l3" href="#language-constructs-that-can-raise-errors">Language constructs that can raise errors</a></li>
                            
                                <li><a class="toctree-l3" href="#comparison-to-exceptions-in-other-languages">Comparison to exceptions in other languages</a></li>
                            
                        
                        </ul>
                    
                </li>
            
        

    
        
        <span>Traits and Interfaces</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../traits-interfaces/traits">Traits</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../traits-interfaces/interfaces">Interfaces</a>
                    
                </li>
            
        

    
        
        <span>Packages</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../packages/package-system">Package system</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../packages/builtin">Builtin</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../packages/use-statement">Using a package</a>
                    
                </li>
            
        

    
        
        <span>Common sugar</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../common-sugar/common-sugar">Sugar</a>
                    
                </li>
            
        

    
        
        <span>Composition vs. inheritance</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../composition-inheritance/code-sharing">Code sharing</a>
                    
                </li>
            
        

    
        
        <span>Algebraic types</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../algebraic-types/union">Union</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../algebraic-types/intersection">Intersection</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../algebraic-types/tuple">Tuple</a>
                    
                </li>
            
        

    
        
        <span>Generics</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../generics/polymorphic-types">Polymorphic types</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../generics/polymorphic-methods">Polymorphic methods</a>
                    
                </li>
            
        

    
        
        <span>Pattern matching</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../pattern-matching/match">match-expression</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../pattern-matching/as">as-expression</a>
                    
                </li>
            
        

    
        
        <span>Object literals</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../object-literals/object-literals">Object literals</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../object-literals/partial-application">Partial application</a>
                    
                </li>
            
        

    
        
        <span>Platform</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../platform/platform">Platform</a>
                    
                </li>
            
        

    
        
        <span>Editor support</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../editor-plugins/plugins">Plugins</a>
                    
                </li>
            
        

    
        
        <span>Compiler options</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../compiler-clargs/clargs">Overview</a>
                    
                </li>
            
        

    
        
        <span>Patterns</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../patterns/patterns">Patterns</a>
                    
                </li>
            
        

    
        
        <span>Garbage collection</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../garbage-collection/garbage-collection">Garbage collection</a>
                    
                </li>
            
        

    
        
        <span>C-FFI</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../c-ffi/calling-c">Calling C programs</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../c-ffi/linking-c">Linking to C libraries</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../c-ffi/c-abi">Exposing a C-ABI</a>
                    
                </li>
            
        

    
        
        <span>Examples</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../examples/examples">Examples</a>
                    
                </li>
            
        

    
</ul>

      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href="../.."></a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    <li>Exceptions</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              <h1 id="exceptions">Exceptions</h1>
<p>Pony provides a simple exception mechanism to simplify error handling. At any point the code may decide to declare an <code>error</code> has occured. Code execution halts at that point and the call chain is unwound until the nearest enclosing error handler is found. This is all checked at compile time so errors cannot cause the whole program to crash.</p>
<h2 id="throwing-and-catching">Throwing and catching</h2>
<p>An error is raised simply with the command <code>error</code>. Error handlers are declared using the try-else syntax.</p>
<pre><code>try
  callA()
  if not callB() then error end
  callC()
else
  callD()
end
</code></pre>

<p>In the above code callA() will always be executed and so will callB(). If the result of callB() is true then we will proceed to callC() in the normal fashion and callD() will not then be executed.</p>
<p>However, if callB() returns false, then an error will be raised. At this point execution will stop and the nearest enclosing error handler will be found and executed. In this example that is our else block and so callD() will be executed.</p>
<p>In either case execution will then carry on will whatever code comes after the try <code>end</code>.</p>
<p><strong>Do I have to provide an error handler?</strong> No. The try block will catch any errors regardless. If you don't provide an error handler then no other action will be taken.</p>
<p>If you want to do something that might raise an error, but you don't care if it does you can simply put in it a try block without an else.</p>
<pre><code>try
  call() // May raise an error
end
</code></pre>

<p><strong>Is there anything my error handler has to do?</strong> No. If you provide an error handler then it must contain some code, but it is entirely up to you what it does.</p>
<h2 id="partial-functions">Partial functions</h2>
<p>Pony does not require that all errors are caught immediately as in our previous examples. Instead functions can throw errors that are caught by whatever code calls them. These are called partial functions (this is a mathmetical term meaning a function that does not have a defined result for all possible inputs, ie arguments). Partial functions <strong>must</strong> be marked as such in Pony with a <code>?</code>.</p>
<pre><code>fun factorial(x: I32): I32 ? =&gt;
  if x &lt; 0 then error end
  if x == 0 then
    1
  else
    x * factorial(x - 1)
  end
</code></pre>

<p>Everywhere that an error can be generated in Pony (an error command, a call to a partial function or certain built-in language constructs) must appear within a try block or a function that is marked as partial. This is checked at compile time, ensuring that an error cannot escape handling and crash the program.</p>
<h2 id="parital-constructors-and-behaviours">Parital constructors and behaviours</h2>
<p>Constructors may also be marked as partial. If a constructor raises an error then the construction is considered to have failed and the object under construction is discarded without ever being returned to the caller.</p>
<p>Behaviours cannot be partial.</p>
<h2 id="try-then-blocks">Try-then blocks</h2>
<p>In addition to an <code>else</code> error handler a try command can have a <code>then</code> block. This is executed after the rest of the try, whether or not an error is caught. Expanding our example from earlier:</p>
<pre><code>try
  callA()
  if not callB() then error end
  callC()
else
  callD()
then
  callE()
end
</code></pre>

<p>The callE() will always be excuted. If callB() returns true then the sequence executed is callA(), callB(), callC(), callE(). If callB() returns false then the sequence executed is callA(), callB(), callD(), callE().</p>
<p><strong>Do I have to have an else error handler to have a then block?</strong> No. You can have a try-then block without an else if you like.</p>
<p><strong>Will my then block really always be executed, even if I return inside the try?</strong> Yes, your then block will <strong>always</strong> be executed when the try block is complete. The only way it won't be is if the try never completes (due to an inifinte loop), the machine is powered off or the process is killed (and then, maybe).</p>
<h2 id="language-constructs-that-can-raise-errors">Language constructs that can raise errors</h2>
<p>The only language construct that can raise an error, other than the error command or calling a partial method, is the <code>as</code> command. This converts the given value to the specified type, if it can be. If it can't then an error is raised. This means that the <code>as</code> command can only be used inside a try block or a partial method.</p>
<h2 id="comparison-to-exceptions-in-other-languages">Comparison to exceptions in other languages</h2>
<p>Pony exceptions behave very much the same as those in C++, Java and C#. The key difference is that Pony exceptions do not have a type or instance associted with them. This makes them the same as C++ exceptions would be if a fixed literal was always thrown, eg <code>throw 3;</code>. This difference simplifies exception handling for the programmer and allows for much better runtime handling performance.</p>
<p>The try <code>else</code> block is just like a <code>catch(...)</code> in C++ or <code>catch(Exception e)</code> in Java or C#. Since exceptions do not have types there is no need for handlers to specify types or to have multiple handlers in a single try block.</p>
<p>The try 'then' block is just like a <code>finally</code> in Java or C#.</p>
<p>If required, error handlers can "rethrow" simply by using the <code>error</code> command within the handler. Since exceptions have no type or instance this is not "the same" exception that was caught by the handler, the question of whether two exceptions "are the same" doesn't mean anything.</p>

            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../traits-interfaces/traits" class="btn btn-neutral float-right" title="Traits"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../actors/arrow-types" class="btn btn-neutral" title="Arrow types"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
        
      <span><a href="../../actors/arrow-types" style="color: #fcfcfc;">&laquo; Previous</a></span>
      <span style="margin-left: 15px"><a href="../../traits-interfaces/traits" style="color: #fcfcfc">Next &raquo;</a></span>
    </span>
</div>
</body>
</html>